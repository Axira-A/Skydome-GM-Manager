# 📖 TRPGGMSys 用户操作手册

欢迎使用 **TRPGGMSys**（桌面角色扮演游戏主持人系统）。本手册将引导您掌握系统的核心功能，助您流畅地主持游戏。

---

## 1. 快速入门

### 首次使用建议流程
1.  **配置世界观**: 进入 **Manager (数据管理)** 页面，预设好游戏中可能出现的物品、敌人、技能和异常状态。
2.  **组建队伍**: 进入 **Overview (总览)** 页面，创建玩家角色 (PC)。
3.  **开始探索**: 进入 **Map (探索)** 页面，生成探索节点。
4.  **遭遇战斗**: 当遭遇敌人时，切换至 **Combat (战斗)** 页面进行结算。

---

## 2. 详细功能说明

### ⚙️ 数据管理 (Manager Page)

此处是游戏数据的后台，您需要在此处定义游戏规则的具体内容。

-   **物品注册 (Item Registry)**:
    -   创建武器、防具、消耗品等。
    -   *注意*: 只有在此注册的物品才能在游戏中被生成或添加到库存。
-   **敌人图鉴 (Bestiary)**:
    -   定义敌人的属性 (HP, 攻击力, 护甲, 辐射值)。
    -   **权重**: 决定该敌人在随机遭遇中出现的概率。
    -   **绑定技能**: 勾选该敌人拥有的技能。
-   **技能与状态**:
    -   定义技能的消耗、冷却和伤害公式（如 `1d10 + SYN`）。
    -   定义异常状态（Buff/Debuff），支持持续回合数和层数叠加。
-   **探索节点配置**:
    -   在此处定义“探索节点注册表”。您可以创建“战斗”、“资源”、“事件”等类型的节点，并为它们绑定特定的**敌人池**或**物品池**。

### 👥 队伍总览 (Overview Page)

此处是玩家角色的核心管理界面。

-   **角色管理**:
    -   点击虚线框 **"Recruit Diver"** 创建新角色。
    -   双击角色卡片头部可打开 **详细编辑模态框**，调整 HP、属性、已习得技能等。
    -   **数值调整器**: 在编辑模式下，支持骰子调整（如 `1d6`）或直接数值增减 HP/侵蚀度，并提供**撤销 (Undo)** 功能。
-   **库存与装备 (Inventory & Equipment)**:
    -   **拖拽装备**: 将物品从背包拖到对应的 **武器/装备/AC核心** 槽位即可装备。
    -   **卸下装备**:
        -   将已装备的物品拖回角色卡片区域（背包）。
        -   或直接拖入底部的 **公共资源箱**。
        -   点击装备槽右上角的微型垃圾桶图标（悬停显示）。
    -   **查看详情与删除**:
        -   点击任意物品（包括公共箱内的）可查看详细描述。
        -   在详情弹窗中点击红色 **"删除物品"** 按钮可将其永久移除。
-   **公共资源箱 (Shared Inventory)**:
    -   全队共用的仓库。支持从此处直接拖拽物品给任意角色装备。
    -   点击 "+" 号可从注册表中快速添加物品。

### 🗺️ 探索系统 (Map Page)

-   **层级选择**: 顶部切换 **浅层 (Shallows)** / **红森林 (RedForest)** / **深空 (DeepSky)**，不同层级对应不同的节点生成权重。
-   **权重配置**: 点击 **"配置生成权重"** 可实时调整当前层级下各类事件（战斗/资源/安全/事件）的出现概率。
-   **节点生成**: 点击 **"Explore Next"**，系统将根据权重及您在 Manager 页面配置的节点注册表，生成一个新的地点。
-   **检定掷骰 (Skill Check)**:
    -   在右侧面板选择角色和属性（PHY/AGI/MND/SYN）。
    -   点击对应按钮进行 d10 骰池检定，系统会自动计算成功数（>=6）和大成功。

### ⚔️ 战斗系统 (Combat Page)

-   **战场布局**:
    -   左侧：我方队员列表。
    -   中间：战斗控制台与日志。
    -   右侧：敌方单位列表。
-   **流程控制**:
    1.  **添加敌人**: 点击右侧标题栏的 **"Add"** 按钮，从图鉴中选择敌人加入战场。
    2.  **选择单位**: 点击左侧或右侧的卡片，分别选中 **攻击者 (Attacker)** 和 **目标 (Target)**。
    3.  **选择技能**: 若攻击者是角色，中间面板会出现技能下拉框。选择技能或留空（普通攻击）。
    4.  **计算预览**: 点击 **"Calculate Attack"**。系统会根据双方属性、护甲、穿透及技能公式计算预估伤害和侵蚀值。
    5.  **应用结果**: 确认无误后，点击红色的 **"Apply Result"** 按钮。伤害、状态效果和侵蚀度将自动扣除并写入角色/敌人状态。
-   **回合结束**: 点击 **"Next Round"** 推进回合计数（未来版本将在此处自动结算 DoT）。

---

## 3. 常见问题 (FAQ)

**Q: 刷新页面后数据还在吗？**
A: 在。系统会自动保存所有数据到浏览器的 LocalStorage 中。但请勿清除浏览器缓存。

**Q: 如何备份我的存档？**
A: 目前版本暂未提供导出文件功能，请避免在隐身模式下长时间运行重要团务。

**Q: 装备拖拽没反应？**
A: 请确保拖拽的目标槽位类型匹配（例如武器只能拖入 Weapon 槽）。如果背包已满，卸下装备时会自动存入公共资源箱。

**Q: 技能公式怎么写？**
A: 支持简单的加法公式，如 `1d10 + SYN` 或 `PHY + 5`。系统会自动识别属性关键词（PHY, AGI, MND, SYN）。

---

*祝您的跑团旅程愉快！*
